import 'import_me'
from 'me2' import 'string'

define nows /\S+/
define quote /\"/
define word /[\w-]+/


grammar dict(default):
    skip ','
    match word ws '=' ws quote string quote:
        out.add_attribute('.', '$0', '$5')
    match '}':
        do.return()

grammar list(default):
    match ',':
        do.next()
    match quote string quote:
        out.create('item', '$1')
    match '{':
        out.open('item')
        dict()
    match ']':
        do.return()

grammar section(default):
    match word ws '=' ws quote string quote nl:
        out.add('$0', '$5')
    match word ws '=' ws '[':
        out.open('$0')
        list()

grammar input(default):
    match '[' word ']' nl:
        out.enter('$1')
        section()
    match '[' word '.' word ']' nl:
        out.enter('$1/$3')
        section()
    out.set_root_name('test')